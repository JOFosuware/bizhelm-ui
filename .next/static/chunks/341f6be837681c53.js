(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54858,e=>{"use strict";async function t(e,s={}){let r=e.startsWith("http")?e:`${"http://localhost:8080/api/v1".replace(/\/$/,"")}${e.startsWith("/")?"":"/"}${e}`,i=await fetch(r,{...s,credentials:"include",headers:{"Content-Type":"application/json",...s.headers||{}}});if(!i.ok){let e=null;try{e=await i.json()}catch{}throw{status:i.status,message:e?.message||i.statusText||"Request failed",details:e?.details}}if(204!==i.status)return await i.json()}e.s(["bhFetch",()=>t])},70065,e=>{"use strict";var t=e.i(43476),s=e.i(47163);function r({className:e,...r}){return(0,t.jsx)("div",{className:(0,s.cn)("rounded-2xl bg-white shadow-soft border border-slate-200",e),...r})}function i({className:e,...r}){return(0,t.jsx)("div",{className:(0,s.cn)("p-5",e),...r})}e.s(["Card",()=>r,"CardContent",()=>i])},19538,e=>{"use strict";let t;e.i(47167);var s=e.i(43476),r=e.i(71645),i=e.i(75555),a=e.i(40143),n=e.i(86491),l=e.i(15823),o=e.i(93803),u=e.i(19273),c=e.i(80166),d=class extends l.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#s=(0,o.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#r=void 0;#i=void 0;#a=void 0;#n;#l;#s;#t;#o;#u;#c;#d;#h;#p;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#r.addObserver(this),h(this.#r,this.options)?this.#f():this.updateResult(),this.#y())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return p(this.#r,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return p(this.#r,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#v(),this.#b(),this.#r.removeObserver(this)}setOptions(e){let t=this.options,s=this.#r;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,u.resolveEnabled)(this.options.enabled,this.#r))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#x(),this.#r.setOptions(this.options),t._defaulted&&!(0,u.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#r,observer:this});let r=this.hasListeners();r&&m(this.#r,s,this.options,t)&&this.#f(),this.updateResult(),r&&(this.#r!==s||(0,u.resolveEnabled)(this.options.enabled,this.#r)!==(0,u.resolveEnabled)(t.enabled,this.#r)||(0,u.resolveStaleTime)(this.options.staleTime,this.#r)!==(0,u.resolveStaleTime)(t.staleTime,this.#r))&&this.#g();let i=this.#R();r&&(this.#r!==s||(0,u.resolveEnabled)(this.options.enabled,this.#r)!==(0,u.resolveEnabled)(t.enabled,this.#r)||i!==this.#p)&&this.#S(i)}getOptimisticResult(e){var t,s;let r=this.#e.getQueryCache().build(this.#e,e),i=this.createResult(r,e);return t=this,s=i,(0,u.shallowEqualObjects)(t.getCurrentResult(),s)||(this.#a=i,this.#l=this.options,this.#n=this.#r.state),i}getCurrentResult(){return this.#a}trackResult(e,t){return new Proxy(e,{get:(e,s)=>(this.trackProp(s),t?.(s),"promise"===s&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#s.status||this.#s.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,s))})}trackProp(e){this.#m.add(e)}getCurrentQuery(){return this.#r}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),s=this.#e.getQueryCache().build(this.#e,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#f({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#a))}#f(e){this.#x();let t=this.#r.fetch(this.options,e);return e?.throwOnError||(t=t.catch(u.noop)),t}#g(){this.#v();let e=(0,u.resolveStaleTime)(this.options.staleTime,this.#r);if(u.isServer||this.#a.isStale||!(0,u.isValidTimeout)(e))return;let t=(0,u.timeUntilStale)(this.#a.dataUpdatedAt,e);this.#d=c.timeoutManager.setTimeout(()=>{this.#a.isStale||this.updateResult()},t+1)}#R(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#r):this.options.refetchInterval)??!1}#S(e){this.#b(),this.#p=e,!u.isServer&&!1!==(0,u.resolveEnabled)(this.options.enabled,this.#r)&&(0,u.isValidTimeout)(this.#p)&&0!==this.#p&&(this.#h=c.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||i.focusManager.isFocused())&&this.#f()},this.#p))}#y(){this.#g(),this.#S(this.#R())}#v(){this.#d&&(c.timeoutManager.clearTimeout(this.#d),this.#d=void 0)}#b(){this.#h&&(c.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let s,r=this.#r,i=this.options,a=this.#a,l=this.#n,c=this.#l,d=e!==r?e.state:this.#i,{state:p}=e,y={...p},v=!1;if(t._optimisticResults){let s=this.hasListeners(),a=!s&&h(e,t),l=s&&m(e,r,t,i);(a||l)&&(y={...y,...(0,n.fetchState)(p.data,e.options)}),"isRestoring"===t._optimisticResults&&(y.fetchStatus="idle")}let{error:b,errorUpdatedAt:x,status:g}=y;s=y.data;let R=!1;if(void 0!==t.placeholderData&&void 0===s&&"pending"===g){let e;a?.isPlaceholderData&&t.placeholderData===c?.placeholderData?(e=a.data,R=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#c?.state.data,this.#c):t.placeholderData,void 0!==e&&(g="success",s=(0,u.replaceData)(a?.data,e,t),v=!0)}if(t.select&&void 0!==s&&!R)if(a&&s===l?.data&&t.select===this.#o)s=this.#u;else try{this.#o=t.select,s=t.select(s),s=(0,u.replaceData)(a?.data,s,t),this.#u=s,this.#t=null}catch(e){this.#t=e}this.#t&&(b=this.#t,s=this.#u,x=Date.now(),g="error");let S="fetching"===y.fetchStatus,_="pending"===g,w="error"===g,C=_&&S,I=void 0!==s,j={status:g,fetchStatus:y.fetchStatus,isPending:_,isSuccess:"success"===g,isError:w,isInitialLoading:C,isLoading:C,data:s,dataUpdatedAt:y.dataUpdatedAt,error:b,errorUpdatedAt:x,failureCount:y.fetchFailureCount,failureReason:y.fetchFailureReason,errorUpdateCount:y.errorUpdateCount,isFetched:y.dataUpdateCount>0||y.errorUpdateCount>0,isFetchedAfterMount:y.dataUpdateCount>d.dataUpdateCount||y.errorUpdateCount>d.errorUpdateCount,isFetching:S,isRefetching:S&&!_,isLoadingError:w&&!I,isPaused:"paused"===y.fetchStatus,isPlaceholderData:v,isRefetchError:w&&I,isStale:f(e,t),refetch:this.refetch,promise:this.#s,isEnabled:!1!==(0,u.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=e=>{"error"===j.status?e.reject(j.error):void 0!==j.data&&e.resolve(j.data)},s=()=>{t(this.#s=j.promise=(0,o.pendingThenable)())},i=this.#s;switch(i.status){case"pending":e.queryHash===r.queryHash&&t(i);break;case"fulfilled":("error"===j.status||j.data!==i.value)&&s();break;case"rejected":("error"!==j.status||j.error!==i.reason)&&s()}}return j}updateResult(){let e=this.#a,t=this.createResult(this.#r,this.options);if(this.#n=this.#r.state,this.#l=this.options,void 0!==this.#n.data&&(this.#c=this.#r),(0,u.shallowEqualObjects)(t,e))return;this.#a=t;let s=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!this.#m.size)return!0;let r=new Set(s??this.#m);return this.options.throwOnError&&r.add("error"),Object.keys(this.#a).some(t=>this.#a[t]!==e[t]&&r.has(t))};this.#_({listeners:s()})}#x(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#r)return;let t=this.#r;this.#r=e,this.#i=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#y()}#_(e){a.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#a)}),this.#e.getQueryCache().notify({query:this.#r,type:"observerResultsUpdated"})})}};function h(e,t){return!1!==(0,u.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&p(e,t,t.refetchOnMount)}function p(e,t,s){if(!1!==(0,u.resolveEnabled)(t.enabled,e)&&"static"!==(0,u.resolveStaleTime)(t.staleTime,e)){let r="function"==typeof s?s(e):s;return"always"===r||!1!==r&&f(e,t)}return!1}function m(e,t,s,r){return(e!==t||!1===(0,u.resolveEnabled)(r.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&f(e,s)}function f(e,t){return!1!==(0,u.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,u.resolveStaleTime)(t.staleTime,e))}var y=e.i(12598),v=r.createContext((t=!1,{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t})),b=r.createContext(!1);b.Provider;var x=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});e.i(54858);let g={me:{id:"00000000-0000-0000-0000-000000000000",email:"demo@bizhelm.app",first_name:"Demo",last_name:"User",role:"Admin"},kpis:{todaySales:1250,cashCollected:980,lowStockCount:4,unpaidBalances:2},products:[{id:101,sku:"SKU-001",name:"Premium Soap",category:"Hygiene",cost_price:3.5,selling_price:7,units:18,reorder_level:20},{id:102,sku:"SKU-002",name:"Hand Sanitizer 500ml",category:"Hygiene",cost_price:4,selling_price:9.5,units:6,reorder_level:12},{id:103,sku:"SKU-003",name:"Rice 5kg",category:"Groceries",cost_price:18,selling_price:25,units:32,reorder_level:15},{id:104,sku:"SKU-004",name:"Tea Bags 100ct",category:"Groceries",cost_price:6,selling_price:10,units:9,reorder_level:10},{id:105,sku:"SKU-005",name:"Notebook A5",category:"Stationery",cost_price:1.2,selling_price:3,units:48,reorder_level:25}],customers:[{id:201,type:"individual",first_name:"Ama",last_name:"Mensah",email:"ama@example.com",phone:"+233 24 000 0000",outstanding_balance:0,lifetime_spend:540},{id:202,type:"business",company_name:"Bluewave Traders",email:"accounts@bluewave.com",phone:"+233 55 000 0000",outstanding_balance:120,lifetime_spend:2450},{id:203,type:"individual",first_name:"Kojo",last_name:"Asante",email:"kojo@example.com",phone:"+233 20 000 0000",outstanding_balance:75,lifetime_spend:980}],sales:[{id:301,sale_number:"S-000301",sale_date:new Date().toISOString(),customer_id:201,customer_name:"Ama Mensah",total_amount:120,amount_paid:120,balance_due:0,status:"paid"},{id:302,sale_number:"S-000302",sale_date:new Date(Date.now()-864e5).toISOString(),customer_id:203,customer_name:"Kojo Asante",total_amount:75,amount_paid:0,balance_due:75,status:"pending"},{id:303,sale_number:"S-000303",sale_date:new Date(Date.now()-1728e5).toISOString(),customer_id:202,customer_name:"Bluewave Traders",total_amount:540,amount_paid:420,balance_due:120,status:"pending"}],purchaseOrders:[{id:401,po_number:"PO-000401",supplier_name:"Accra Supply Co.",created_at:new Date(Date.now()-2592e5).toISOString(),expected_delivery:new Date(Date.now()+1728e5).toISOString(),total_amount:980,status:"ordered"},{id:402,po_number:"PO-000402",supplier_name:"Coastal Wholesale",created_at:new Date(Date.now()-864e6).toISOString(),expected_delivery:new Date(Date.now()-1728e5).toISOString(),total_amount:420,status:"partially_received"}],suppliers:[{id:701,name:"Accra Supply Co.",phone:"+233 30 000 0000",email:"sales@accrasupply.example",address:"Accra"},{id:702,name:"Coastal Wholesale",phone:"+233 31 000 0000",email:"orders@coastal.example",address:"Cape Coast"}],invoices:[{id:501,invoice_number:"INV-000501",customer_name:"Bluewave Traders",issue_date:new Date(Date.now()-6912e5).toISOString(),due_date:new Date(Date.now()-864e5).toISOString(),total_amount:540,status:"overdue"},{id:502,invoice_number:"INV-000502",customer_name:"Kojo Asante",issue_date:new Date(Date.now()-864e5).toISOString(),due_date:new Date(Date.now()+5184e5).toISOString(),total_amount:75,status:"sent"}],expenses:[{id:601,expense_date:new Date(Date.now()-1728e5).toISOString(),category:"Utilities",vendor:"ECG",description:"Electricity",amount:120,receipt_url:""},{id:602,expense_date:new Date(Date.now()-432e6).toISOString(),category:"Transport",vendor:"Fuel",description:"Delivery fuel",amount:85,receipt_url:""}]};function R(e,t="GHS"){try{return new Intl.NumberFormat(void 0,{style:"currency",currency:t}).format(e)}catch{return`${t} ${e.toFixed(2)}`}}var S=e.i(67881),_=e.i(23750),w=e.i(70065),C=e.i(47163);let I={default:"bg-slate-100 text-slate-700",secondary:"bg-slate-100 text-slate-700",success:"bg-emerald-100 text-emerald-700",warning:"bg-amber-100 text-amber-800",danger:"bg-red-100 text-red-700",info:"bg-sky-100 text-sky-700"};function j({variant:e="default",className:t,children:r}){return(0,s.jsx)("span",{className:(0,C.cn)("inline-flex h-6 items-center rounded-full px-2 text-xs font-medium",I[e],t),children:r})}function Q(){let[e,t]=r.useState(""),[i,n]=r.useState([]),l=function(e,t,s){let i=r.useContext(b),n=r.useContext(v),l=(0,y.useQueryClient)(s),o=l.defaultQueryOptions(e);if(l.getDefaultOptions().queries?._experimental_beforeQuery?.(o),o._optimisticResults=i?"isRestoring":"optimistic",o.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=o.staleTime;o.staleTime="function"==typeof t?(...s)=>e(t(...s)):e(t),"number"==typeof o.gcTime&&(o.gcTime=Math.max(o.gcTime,1e3))}(o.suspense||o.throwOnError||o.experimental_prefetchInRender)&&!n.isReset()&&(o.retryOnMount=!1),r.useEffect(()=>{n.clearReset()},[n]);let c=!l.getQueryCache().get(o.queryHash),[d]=r.useState(()=>new t(l,o)),h=d.getOptimisticResult(o),p=!i&&!1!==e.subscribed;if(r.useSyncExternalStore(r.useCallback(e=>{let t=p?d.subscribe(a.notifyManager.batchCalls(e)):u.noop;return d.updateResult(),t},[d,p]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),r.useEffect(()=>{d.setOptions(o)},[o,d]),o?.suspense&&h.isPending)throw x(o,d,n);if((({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(i&&void 0===e.data||(0,u.shouldThrowError)(s,[e.error,r])))({result:h,errorResetBoundary:n,throwOnError:o.throwOnError,query:l.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw h.error;if(l.getDefaultOptions().queries?._experimental_afterQuery?.(o,h),o.experimental_prefetchInRender&&!u.isServer&&h.isLoading&&h.isFetching&&!i){let e=c?x(o,d,n):l.getQueryCache().get(o.queryHash)?.promise;e?.catch(u.noop).finally(()=>{d.updateResult()})}return o.notifyOnChangeProps?h:d.trackResult(h)}({queryKey:["products",e,!0],queryFn:async()=>{{let t=e.toLowerCase();return g.products.filter(e=>!t||e.name.toLowerCase().includes(t)||e.sku.toLowerCase().includes(t))}},staleTime:15e3},d,void 0),o=l.data||[],c=i.reduce((e,t)=>e+t.qty*t.product.selling_price,0);async function h(){alert("Checkout stub. Wire this to POST /pos/sales and redirect to /sales/{id}.")}return(0,s.jsxs)("div",{className:"grid gap-4 lg:grid-cols-3",children:[(0,s.jsx)(w.Card,{className:"lg:col-span-2",children:(0,s.jsxs)(w.CardContent,{className:"p-4",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-semibold",children:"Product search"}),(0,s.jsx)("div",{className:"text-xs text-slate-500",children:"Add items to cart. Barcode scanner can focus this field."})]})}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(_.Input,{value:e,onChange:e=>t(e.target.value),placeholder:"Search by name / SKU / barcode…"})}),(0,s.jsxs)("div",{className:"mt-4 grid gap-2 md:grid-cols-2",children:[o.map(e=>{let t=e.units<=e.reorder_level;return(0,s.jsxs)("button",{className:"flex items-start justify-between gap-3 rounded-2xl border border-slate-200 bg-white p-3 text-left hover:bg-slate-50",onClick:()=>{n(t=>{let s=t.findIndex(t=>t.product.id===e.id);if(s>=0){let e=[...t];return e[s]={...e[s],qty:e[s].qty+1},e}return[...t,{product:e,qty:1}]})},children:[(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("div",{className:"truncate text-sm font-medium",children:e.name}),(0,s.jsxs)("div",{className:"mt-1 text-xs text-slate-500",children:[e.sku," • ",R(e.selling_price)]}),(0,s.jsxs)("div",{className:"mt-1 text-xs text-slate-500",children:["Stock: ",e.units]})]}),(0,s.jsx)(j,{variant:0===e.units?"danger":t?"warning":"secondary",children:0===e.units?"Out":t?"Low":"Add"})]},e.id)}),l.isLoading?(0,s.jsx)("div",{className:"text-sm text-slate-600",children:"Loading…"}):null,l.isLoading||0!==o.length?null:(0,s.jsx)("div",{className:"text-sm text-slate-600",children:"No products."})]})]})}),(0,s.jsx)(w.Card,{children:(0,s.jsxs)(w.CardContent,{className:"p-4",children:[(0,s.jsx)("div",{className:"text-sm font-semibold",children:"Cart"}),(0,s.jsx)("div",{className:"mt-1 text-xs text-slate-500",children:"Review quantities and collect payment."}),(0,s.jsxs)("div",{className:"mt-4 space-y-3",children:[i.map(e=>(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 p-3",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("div",{className:"truncate text-sm font-medium",children:e.product.name}),(0,s.jsxs)("div",{className:"mt-1 text-xs text-slate-500",children:[R(e.product.selling_price)," each"]})]}),(0,s.jsx)("button",{className:"text-xs text-slate-500 hover:text-slate-900",onClick:()=>{var t;return t=e.product.id,void n(e=>e.filter(e=>e.product.id!==t))},children:"Remove"})]}),(0,s.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("label",{className:"text-xs text-slate-500",children:"Qty"}),(0,s.jsx)("input",{className:"h-9 w-16 rounded-xl border border-slate-200 px-2 text-sm",type:"number",min:1,value:e.qty,onChange:t=>{var s,r;return s=e.product.id,r=Number(t.target.value),void n(e=>e.map(e=>e.product.id===s?{...e,qty:Math.max(1,r)}:e))}})]}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:R(e.qty*e.product.selling_price)})]})]},e.product.id)),0===i.length?(0,s.jsx)("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-4 text-sm text-slate-600",children:"Cart is empty. Add products on the left."}):null]}),(0,s.jsxs)("div",{className:"mt-4 border-t border-slate-200 pt-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-slate-600",children:"Subtotal"}),(0,s.jsx)("span",{className:"font-semibold",children:R(c)})]}),(0,s.jsx)(S.Button,{className:"mt-3 w-full",disabled:0===i.length,onClick:h,children:"Checkout"})]})]})})]})}e.s(["PosTerminal",()=>Q],19538)}]);