module.exports=[82180,a=>{"use strict";let b;var c=a.i(87924),d=a.i(72131),e=a.i(99745),f=a.i(18544),g=a.i(76644),h=a.i(33791),i=a.i(79715),j=a.i(42871),k=a.i(8361),l=class extends h.Subscribable{constructor(a,b){super(),this.options=b,this.#a=a,this.#b=null,this.#c=(0,i.pendingThenable)(),this.bindMethods(),this.setOptions(b)}#a;#d=void 0;#e=void 0;#f=void 0;#g;#h;#c;#b;#i;#j;#k;#l;#m;#n;#o=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#d.addObserver(this),m(this.#d,this.options)?this.#p():this.updateResult(),this.#q())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return n(this.#d,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return n(this.#d,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#r(),this.#s(),this.#d.removeObserver(this)}setOptions(a){let b=this.options,c=this.#d;if(this.options=this.#a.defaultQueryOptions(a),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,j.resolveEnabled)(this.options.enabled,this.#d))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#t(),this.#d.setOptions(this.options),b._defaulted&&!(0,j.shallowEqualObjects)(this.options,b)&&this.#a.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#d,observer:this});let d=this.hasListeners();d&&o(this.#d,c,this.options,b)&&this.#p(),this.updateResult(),d&&(this.#d!==c||(0,j.resolveEnabled)(this.options.enabled,this.#d)!==(0,j.resolveEnabled)(b.enabled,this.#d)||(0,j.resolveStaleTime)(this.options.staleTime,this.#d)!==(0,j.resolveStaleTime)(b.staleTime,this.#d))&&this.#u();let e=this.#v();d&&(this.#d!==c||(0,j.resolveEnabled)(this.options.enabled,this.#d)!==(0,j.resolveEnabled)(b.enabled,this.#d)||e!==this.#n)&&this.#w(e)}getOptimisticResult(a){var b,c;let d=this.#a.getQueryCache().build(this.#a,a),e=this.createResult(d,a);return b=this,c=e,(0,j.shallowEqualObjects)(b.getCurrentResult(),c)||(this.#f=e,this.#h=this.options,this.#g=this.#d.state),e}getCurrentResult(){return this.#f}trackResult(a,b){return new Proxy(a,{get:(a,c)=>(this.trackProp(c),b?.(c),"promise"===c&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#c.status||this.#c.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(a,c))})}trackProp(a){this.#o.add(a)}getCurrentQuery(){return this.#d}refetch({...a}={}){return this.fetch({...a})}fetchOptimistic(a){let b=this.#a.defaultQueryOptions(a),c=this.#a.getQueryCache().build(this.#a,b);return c.fetch().then(()=>this.createResult(c,b))}fetch(a){return this.#p({...a,cancelRefetch:a.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#f))}#p(a){this.#t();let b=this.#d.fetch(this.options,a);return a?.throwOnError||(b=b.catch(j.noop)),b}#u(){this.#r();let a=(0,j.resolveStaleTime)(this.options.staleTime,this.#d);if(j.isServer||this.#f.isStale||!(0,j.isValidTimeout)(a))return;let b=(0,j.timeUntilStale)(this.#f.dataUpdatedAt,a);this.#l=k.timeoutManager.setTimeout(()=>{this.#f.isStale||this.updateResult()},b+1)}#v(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#d):this.options.refetchInterval)??!1}#w(a){this.#s(),this.#n=a,!j.isServer&&!1!==(0,j.resolveEnabled)(this.options.enabled,this.#d)&&(0,j.isValidTimeout)(this.#n)&&0!==this.#n&&(this.#m=k.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||e.focusManager.isFocused())&&this.#p()},this.#n))}#q(){this.#u(),this.#w(this.#v())}#r(){this.#l&&(k.timeoutManager.clearTimeout(this.#l),this.#l=void 0)}#s(){this.#m&&(k.timeoutManager.clearInterval(this.#m),this.#m=void 0)}createResult(a,b){let c,d=this.#d,e=this.options,f=this.#f,h=this.#g,k=this.#h,l=a!==d?a.state:this.#e,{state:n}=a,q={...n},r=!1;if(b._optimisticResults){let c=this.hasListeners(),f=!c&&m(a,b),h=c&&o(a,d,b,e);(f||h)&&(q={...q,...(0,g.fetchState)(n.data,a.options)}),"isRestoring"===b._optimisticResults&&(q.fetchStatus="idle")}let{error:s,errorUpdatedAt:t,status:u}=q;c=q.data;let v=!1;if(void 0!==b.placeholderData&&void 0===c&&"pending"===u){let a;f?.isPlaceholderData&&b.placeholderData===k?.placeholderData?(a=f.data,v=!0):a="function"==typeof b.placeholderData?b.placeholderData(this.#k?.state.data,this.#k):b.placeholderData,void 0!==a&&(u="success",c=(0,j.replaceData)(f?.data,a,b),r=!0)}if(b.select&&void 0!==c&&!v)if(f&&c===h?.data&&b.select===this.#i)c=this.#j;else try{this.#i=b.select,c=b.select(c),c=(0,j.replaceData)(f?.data,c,b),this.#j=c,this.#b=null}catch(a){this.#b=a}this.#b&&(s=this.#b,c=this.#j,t=Date.now(),u="error");let w="fetching"===q.fetchStatus,x="pending"===u,y="error"===u,z=x&&w,A=void 0!==c,B={status:u,fetchStatus:q.fetchStatus,isPending:x,isSuccess:"success"===u,isError:y,isInitialLoading:z,isLoading:z,data:c,dataUpdatedAt:q.dataUpdatedAt,error:s,errorUpdatedAt:t,failureCount:q.fetchFailureCount,failureReason:q.fetchFailureReason,errorUpdateCount:q.errorUpdateCount,isFetched:q.dataUpdateCount>0||q.errorUpdateCount>0,isFetchedAfterMount:q.dataUpdateCount>l.dataUpdateCount||q.errorUpdateCount>l.errorUpdateCount,isFetching:w,isRefetching:w&&!x,isLoadingError:y&&!A,isPaused:"paused"===q.fetchStatus,isPlaceholderData:r,isRefetchError:y&&A,isStale:p(a,b),refetch:this.refetch,promise:this.#c,isEnabled:!1!==(0,j.resolveEnabled)(b.enabled,a)};if(this.options.experimental_prefetchInRender){let b=a=>{"error"===B.status?a.reject(B.error):void 0!==B.data&&a.resolve(B.data)},c=()=>{b(this.#c=B.promise=(0,i.pendingThenable)())},e=this.#c;switch(e.status){case"pending":a.queryHash===d.queryHash&&b(e);break;case"fulfilled":("error"===B.status||B.data!==e.value)&&c();break;case"rejected":("error"!==B.status||B.error!==e.reason)&&c()}}return B}updateResult(){let a=this.#f,b=this.createResult(this.#d,this.options);if(this.#g=this.#d.state,this.#h=this.options,void 0!==this.#g.data&&(this.#k=this.#d),(0,j.shallowEqualObjects)(b,a))return;this.#f=b;let c=()=>{if(!a)return!0;let{notifyOnChangeProps:b}=this.options,c="function"==typeof b?b():b;if("all"===c||!c&&!this.#o.size)return!0;let d=new Set(c??this.#o);return this.options.throwOnError&&d.add("error"),Object.keys(this.#f).some(b=>this.#f[b]!==a[b]&&d.has(b))};this.#x({listeners:c()})}#t(){let a=this.#a.getQueryCache().build(this.#a,this.options);if(a===this.#d)return;let b=this.#d;this.#d=a,this.#e=a.state,this.hasListeners()&&(b?.removeObserver(this),a.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#q()}#x(a){f.notifyManager.batch(()=>{a.listeners&&this.listeners.forEach(a=>{a(this.#f)}),this.#a.getQueryCache().notify({query:this.#d,type:"observerResultsUpdated"})})}};function m(a,b){return!1!==(0,j.resolveEnabled)(b.enabled,a)&&void 0===a.state.data&&("error"!==a.state.status||!1!==b.retryOnMount)||void 0!==a.state.data&&n(a,b,b.refetchOnMount)}function n(a,b,c){if(!1!==(0,j.resolveEnabled)(b.enabled,a)&&"static"!==(0,j.resolveStaleTime)(b.staleTime,a)){let d="function"==typeof c?c(a):c;return"always"===d||!1!==d&&p(a,b)}return!1}function o(a,b,c,d){return(a!==b||!1===(0,j.resolveEnabled)(d.enabled,a))&&(!c.suspense||"error"!==a.state.status)&&p(a,c)}function p(a,b){return!1!==(0,j.resolveEnabled)(b.enabled,a)&&a.isStaleByTime((0,j.resolveStaleTime)(b.staleTime,a))}var q=a.i(37927),r=d.createContext((b=!1,{clearReset:()=>{b=!1},reset:()=>{b=!0},isReset:()=>b})),s=d.createContext(!1);s.Provider;var t=(a,b,c)=>b.fetchOptimistic(a).catch(()=>{c.clearReset()});a.i(53250);let u={me:{id:"00000000-0000-0000-0000-000000000000",email:"demo@bizhelm.app",first_name:"Demo",last_name:"User",role:"Admin"},kpis:{todaySales:1250,cashCollected:980,lowStockCount:4,unpaidBalances:2},products:[{id:101,sku:"SKU-001",name:"Premium Soap",category:"Hygiene",cost_price:3.5,selling_price:7,units:18,reorder_level:20},{id:102,sku:"SKU-002",name:"Hand Sanitizer 500ml",category:"Hygiene",cost_price:4,selling_price:9.5,units:6,reorder_level:12},{id:103,sku:"SKU-003",name:"Rice 5kg",category:"Groceries",cost_price:18,selling_price:25,units:32,reorder_level:15},{id:104,sku:"SKU-004",name:"Tea Bags 100ct",category:"Groceries",cost_price:6,selling_price:10,units:9,reorder_level:10},{id:105,sku:"SKU-005",name:"Notebook A5",category:"Stationery",cost_price:1.2,selling_price:3,units:48,reorder_level:25}],customers:[{id:201,type:"individual",first_name:"Ama",last_name:"Mensah",email:"ama@example.com",phone:"+233 24 000 0000",outstanding_balance:0,lifetime_spend:540},{id:202,type:"business",company_name:"Bluewave Traders",email:"accounts@bluewave.com",phone:"+233 55 000 0000",outstanding_balance:120,lifetime_spend:2450},{id:203,type:"individual",first_name:"Kojo",last_name:"Asante",email:"kojo@example.com",phone:"+233 20 000 0000",outstanding_balance:75,lifetime_spend:980}],sales:[{id:301,sale_number:"S-000301",sale_date:new Date().toISOString(),customer_id:201,customer_name:"Ama Mensah",total_amount:120,amount_paid:120,balance_due:0,status:"paid"},{id:302,sale_number:"S-000302",sale_date:new Date(Date.now()-864e5).toISOString(),customer_id:203,customer_name:"Kojo Asante",total_amount:75,amount_paid:0,balance_due:75,status:"pending"},{id:303,sale_number:"S-000303",sale_date:new Date(Date.now()-1728e5).toISOString(),customer_id:202,customer_name:"Bluewave Traders",total_amount:540,amount_paid:420,balance_due:120,status:"pending"}],purchaseOrders:[{id:401,po_number:"PO-000401",supplier_name:"Accra Supply Co.",created_at:new Date(Date.now()-2592e5).toISOString(),expected_delivery:new Date(Date.now()+1728e5).toISOString(),total_amount:980,status:"ordered"},{id:402,po_number:"PO-000402",supplier_name:"Coastal Wholesale",created_at:new Date(Date.now()-864e6).toISOString(),expected_delivery:new Date(Date.now()-1728e5).toISOString(),total_amount:420,status:"partially_received"}],suppliers:[{id:701,name:"Accra Supply Co.",phone:"+233 30 000 0000",email:"sales@accrasupply.example",address:"Accra"},{id:702,name:"Coastal Wholesale",phone:"+233 31 000 0000",email:"orders@coastal.example",address:"Cape Coast"}],invoices:[{id:501,invoice_number:"INV-000501",customer_name:"Bluewave Traders",issue_date:new Date(Date.now()-6912e5).toISOString(),due_date:new Date(Date.now()-864e5).toISOString(),total_amount:540,status:"overdue"},{id:502,invoice_number:"INV-000502",customer_name:"Kojo Asante",issue_date:new Date(Date.now()-864e5).toISOString(),due_date:new Date(Date.now()+5184e5).toISOString(),total_amount:75,status:"sent"}],expenses:[{id:601,expense_date:new Date(Date.now()-1728e5).toISOString(),category:"Utilities",vendor:"ECG",description:"Electricity",amount:120,receipt_url:""},{id:602,expense_date:new Date(Date.now()-432e6).toISOString(),category:"Transport",vendor:"Fuel",description:"Delivery fuel",amount:85,receipt_url:""}]};function v(a,b="GHS"){try{return new Intl.NumberFormat(void 0,{style:"currency",currency:b}).format(a)}catch{return`${b} ${a.toFixed(2)}`}}var w=a.i(40695),x=a.i(5522),y=a.i(3130),z=a.i(97895);let A={default:"bg-slate-100 text-slate-700",secondary:"bg-slate-100 text-slate-700",success:"bg-emerald-100 text-emerald-700",warning:"bg-amber-100 text-amber-800",danger:"bg-red-100 text-red-700",info:"bg-sky-100 text-sky-700"};function B({variant:a="default",className:b,children:d}){return(0,c.jsx)("span",{className:(0,z.cn)("inline-flex h-6 items-center rounded-full px-2 text-xs font-medium",A[a],b),children:d})}function C(){let[a,b]=d.useState(""),[e,g]=d.useState([]),h=function(a,b,c){let e=d.useContext(s),g=d.useContext(r),h=(0,q.useQueryClient)(c),i=h.defaultQueryOptions(a);if(h.getDefaultOptions().queries?._experimental_beforeQuery?.(i),i._optimisticResults=e?"isRestoring":"optimistic",i.suspense){let a=a=>"static"===a?a:Math.max(a??1e3,1e3),b=i.staleTime;i.staleTime="function"==typeof b?(...c)=>a(b(...c)):a(b),"number"==typeof i.gcTime&&(i.gcTime=Math.max(i.gcTime,1e3))}(i.suspense||i.throwOnError||i.experimental_prefetchInRender)&&!g.isReset()&&(i.retryOnMount=!1),d.useEffect(()=>{g.clearReset()},[g]);let k=!h.getQueryCache().get(i.queryHash),[l]=d.useState(()=>new b(h,i)),m=l.getOptimisticResult(i),n=!e&&!1!==a.subscribed;if(d.useSyncExternalStore(d.useCallback(a=>{let b=n?l.subscribe(f.notifyManager.batchCalls(a)):j.noop;return l.updateResult(),b},[l,n]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),d.useEffect(()=>{l.setOptions(i)},[i,l]),i?.suspense&&m.isPending)throw t(i,l,g);if((({result:a,errorResetBoundary:b,throwOnError:c,query:d,suspense:e})=>a.isError&&!b.isReset()&&!a.isFetching&&d&&(e&&void 0===a.data||(0,j.shouldThrowError)(c,[a.error,d])))({result:m,errorResetBoundary:g,throwOnError:i.throwOnError,query:h.getQueryCache().get(i.queryHash),suspense:i.suspense}))throw m.error;if(h.getDefaultOptions().queries?._experimental_afterQuery?.(i,m),i.experimental_prefetchInRender&&!j.isServer&&m.isLoading&&m.isFetching&&!e){let a=k?t(i,l,g):h.getQueryCache().get(i.queryHash)?.promise;a?.catch(j.noop).finally(()=>{l.updateResult()})}return i.notifyOnChangeProps?m:l.trackResult(m)}({queryKey:["products",a,!0],queryFn:async()=>{{let b=a.toLowerCase();return u.products.filter(a=>!b||a.name.toLowerCase().includes(b)||a.sku.toLowerCase().includes(b))}},staleTime:15e3},l,void 0),i=h.data||[],k=e.reduce((a,b)=>a+b.qty*b.product.selling_price,0);async function m(){alert("Checkout stub. Wire this to POST /pos/sales and redirect to /sales/{id}.")}return(0,c.jsxs)("div",{className:"grid gap-4 lg:grid-cols-3",children:[(0,c.jsx)(y.Card,{className:"lg:col-span-2",children:(0,c.jsxs)(y.CardContent,{className:"p-4",children:[(0,c.jsx)("div",{className:"flex items-center justify-between",children:(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-sm font-semibold",children:"Product search"}),(0,c.jsx)("div",{className:"text-xs text-slate-500",children:"Add items to cart. Barcode scanner can focus this field."})]})}),(0,c.jsx)("div",{className:"mt-4",children:(0,c.jsx)(x.Input,{value:a,onChange:a=>b(a.target.value),placeholder:"Search by name / SKU / barcode…"})}),(0,c.jsxs)("div",{className:"mt-4 grid gap-2 md:grid-cols-2",children:[i.map(a=>{let b=a.units<=a.reorder_level;return(0,c.jsxs)("button",{className:"flex items-start justify-between gap-3 rounded-2xl border border-slate-200 bg-white p-3 text-left hover:bg-slate-50",onClick:()=>{g(b=>{let c=b.findIndex(b=>b.product.id===a.id);if(c>=0){let a=[...b];return a[c]={...a[c],qty:a[c].qty+1},a}return[...b,{product:a,qty:1}]})},children:[(0,c.jsxs)("div",{className:"min-w-0",children:[(0,c.jsx)("div",{className:"truncate text-sm font-medium",children:a.name}),(0,c.jsxs)("div",{className:"mt-1 text-xs text-slate-500",children:[a.sku," • ",v(a.selling_price)]}),(0,c.jsxs)("div",{className:"mt-1 text-xs text-slate-500",children:["Stock: ",a.units]})]}),(0,c.jsx)(B,{variant:0===a.units?"danger":b?"warning":"secondary",children:0===a.units?"Out":b?"Low":"Add"})]},a.id)}),h.isLoading?(0,c.jsx)("div",{className:"text-sm text-slate-600",children:"Loading…"}):null,h.isLoading||0!==i.length?null:(0,c.jsx)("div",{className:"text-sm text-slate-600",children:"No products."})]})]})}),(0,c.jsx)(y.Card,{children:(0,c.jsxs)(y.CardContent,{className:"p-4",children:[(0,c.jsx)("div",{className:"text-sm font-semibold",children:"Cart"}),(0,c.jsx)("div",{className:"mt-1 text-xs text-slate-500",children:"Review quantities and collect payment."}),(0,c.jsxs)("div",{className:"mt-4 space-y-3",children:[e.map(a=>(0,c.jsxs)("div",{className:"rounded-2xl border border-slate-200 p-3",children:[(0,c.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,c.jsxs)("div",{className:"min-w-0",children:[(0,c.jsx)("div",{className:"truncate text-sm font-medium",children:a.product.name}),(0,c.jsxs)("div",{className:"mt-1 text-xs text-slate-500",children:[v(a.product.selling_price)," each"]})]}),(0,c.jsx)("button",{className:"text-xs text-slate-500 hover:text-slate-900",onClick:()=>{var b;return b=a.product.id,void g(a=>a.filter(a=>a.product.id!==b))},children:"Remove"})]}),(0,c.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("label",{className:"text-xs text-slate-500",children:"Qty"}),(0,c.jsx)("input",{className:"h-9 w-16 rounded-xl border border-slate-200 px-2 text-sm",type:"number",min:1,value:a.qty,onChange:b=>{var c,d;return c=a.product.id,d=Number(b.target.value),void g(a=>a.map(a=>a.product.id===c?{...a,qty:Math.max(1,d)}:a))}})]}),(0,c.jsx)("div",{className:"text-sm font-semibold",children:v(a.qty*a.product.selling_price)})]})]},a.product.id)),0===e.length?(0,c.jsx)("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-4 text-sm text-slate-600",children:"Cart is empty. Add products on the left."}):null]}),(0,c.jsxs)("div",{className:"mt-4 border-t border-slate-200 pt-4",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,c.jsx)("span",{className:"text-slate-600",children:"Subtotal"}),(0,c.jsx)("span",{className:"font-semibold",children:v(k)})]}),(0,c.jsx)(w.Button,{className:"mt-3 w-full",disabled:0===e.length,onClick:m,children:"Checkout"})]})]})})]})}a.s(["PosTerminal",()=>C],82180)}];

//# sourceMappingURL=components_pos_pos-terminal_tsx_3041b339._.js.map