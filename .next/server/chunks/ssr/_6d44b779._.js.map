{"version":3,"sources":["../../../../components/ui/card.tsx","../../../../lib/api.ts","../../../../app/%28app%29/purchase-orders/%5Bid%5D/receive/page.tsx","../../../../components/ui/page-header.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\nexport function Card({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"rounded-2xl bg-white shadow-soft border border-slate-200\", className)}\n      {...props}\n    />\n  );\n}\n\nexport function CardHeader({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return <div className={cn(\"p-5 pb-0\", className)} {...props} />;\n}\n\nexport function CardContent({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return <div className={cn(\"p-5\", className)} {...props} />;\n}\n\nexport function CardFooter({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return <div className={cn(\"p-5 pt-0\", className)} {...props} />;\n}\n","export type ApiError = {\n  status: number;\n  message: string;\n  details?: unknown;\n};\n\nfunction getBaseUrl() {\n  const base = process.env.NEXT_PUBLIC_API_BASE_URL;\n  if (!base) return \"http://localhost:8080/api/v1\";\n  return base.replace(/\\/$/, \"\");\n}\n\nexport async function bhFetch<T>(\n  path: string,\n  init: RequestInit = {}\n): Promise<T> {\n  const url = path.startsWith(\"http\") ? path : `${getBaseUrl()}${path.startsWith(\"/\") ? \"\" : \"/\"}${path}`;\n  const res = await fetch(url, {\n    ...init,\n    credentials: \"include\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...(init.headers || {})\n    }\n  });\n\n  if (!res.ok) {\n    let payload: any = null;\n    try { payload = await res.json(); } catch {}\n    const err: ApiError = {\n      status: res.status,\n      message: payload?.message || res.statusText || \"Request failed\",\n      details: payload?.details\n    };\n    throw err;\n  }\n\n  // Handle 204\n  if (res.status === 204) return undefined as T;\n\n  return (await res.json()) as T;\n}\n","\"use client\";\n\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\nimport * as React from \"react\";\nimport { PageHeader } from \"@/components/ui/page-header\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { bhFetch } from \"@/lib/api\";\n\nexport default function ReceivePurchaseOrderPage({ params }: { params: { id: string } }) {\n  const router = useRouter();\n  const poId = Number(params.id);\n  const [loading, setLoading] = React.useState(false);\n  const [error, setError] = React.useState<string | null>(null);\n  const [success, setSuccess] = React.useState(false);\n\n  // UI starter: in real implementation load PO items and allow per-line receiving.\n  const [note, setNote] = React.useState(\"\");\n\n  async function onReceive() {\n    setLoading(true);\n    setError(null);\n    try {\n      const mockMode = process.env.NEXT_PUBLIC_MOCK_MODE === \"true\";\n      if (!mockMode) {\n        await bhFetch(`/purchase-orders/${poId}/receive`, {\n          method: \"POST\",\n          body: JSON.stringify({ items: [], note })\n        });\n      }\n      setSuccess(true);\n      setTimeout(() => {\n        router.push(`/purchase-orders/${poId}`);\n        router.refresh();\n      }, 700);\n    } catch (err: any) {\n      setError(err?.message || \"Receive failed\");\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <PageHeader\n        title=\"Receive Purchase Order\"\n        subtitle=\"Confirm delivered quantities and add stock to inventory (ledger-backed).\"\n        secondary={<Link href={`/purchase-orders/${poId}`} className=\"text-sm text-slate-600 hover:text-slate-900 hover:underline\">← Back to PO</Link>}\n      />\n\n      <Card>\n        <CardContent className=\"p-4\">\n          <div className=\"text-sm font-semibold\">Receiving note</div>\n          <div className=\"mt-1 text-xs text-slate-500\">\n            This starter intentionally keeps receiving simple. In your final UI, render PO line items with quantity ordered vs received.\n          </div>\n\n          <div className=\"mt-4\">\n            <label className=\"text-xs font-medium text-slate-600\">Internal note (optional)</label>\n            <Input value={note} onChange={(e) => setNote(e.target.value)} placeholder=\"e.g. Delivered 2 cartons damaged; returned\" />\n          </div>\n\n          {success ? <div className=\"mt-4 rounded-xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700\">Received! Updating inventory…</div> : null}\n          {error ? <div className=\"mt-4 rounded-xl border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700\">{error}</div> : null}\n\n          <div className=\"mt-4 flex items-center justify-end gap-2\">\n            <Button variant=\"secondary\" asChild><Link href={`/purchase-orders/${poId}`}>Cancel</Link></Button>\n            <Button onClick={onReceive} disabled={loading}>{loading ? \"Receiving…\" : \"Receive stock\"}</Button>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","import Link from \"next/link\";\nimport { Button } from \"@/components/ui/button\";\n\nexport function PageHeader({\n  title,\n  subtitle,\n  actionLabel,\n  actionHref,\n  onAction,\n  secondary\n}: {\n  title: string;\n  subtitle?: string;\n  actionLabel?: string;\n  actionHref?: string;\n  onAction?: () => void;\n  secondary?: React.ReactNode;\n}) {\n  return (\n    <div className=\"mb-5 flex flex-col gap-3 md:flex-row md:items-end md:justify-between\">\n      <div>\n        <h1 className=\"text-xl font-semibold tracking-tight\">{title}</h1>\n        {subtitle ? <p className=\"mt-1 text-sm text-slate-600\">{subtitle}</p> : null}\n      </div>\n      <div className=\"flex items-center gap-2\">\n        {secondary}\n        {actionLabel && actionHref ? (\n          <Button asChild>\n            <Link href={actionHref}>{actionLabel}</Link>\n          </Button>\n        ) : actionLabel && onAction ? (\n          <Button onClick={onAction}>{actionLabel}</Button>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}